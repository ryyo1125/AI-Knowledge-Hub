# AI Coding Knowledge Hub - 機能一覧仕様書

**バージョン**: 1.0
**作成日**: 2026-02-01
**関連**: [PRD_01_Overview.md](PRD_01_Overview.md), [PRD_02_Technical.md](PRD_02_Technical.md), [PRD_03_UI_Specification.md](PRD_03_UI_Specification.md)

---

## 1. 機能マップ

```
┌─────────────────────────────────────────────────────────────────┐
│                    AI Coding Knowledge Hub                       │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐          │
│  │ 情報収集機能  │→│ AI分析機能   │→│ レビュー機能  │          │
│  │ (F-1xx)      │  │ (F-2xx)      │  │ (F-3xx)      │          │
│  └──────────────┘  └──────────────┘  └──────────────┘          │
│         ↓                                    ↓                   │
│  ┌──────────────┐                    ┌──────────────┐          │
│  │ ソース管理    │                    │ レポート機能  │          │
│  │ (F-4xx)      │                    │ (F-5xx)      │          │
│  └──────────────┘                    └──────────────┘          │
│                                              ↓                   │
│                                      ┌──────────────┐          │
│                                      │ マニュアル機能│          │
│                                      │ (F-6xx) Ph2  │          │
│                                      └──────────────┘          │
│                                                                  │
│  ┌──────────────────────────────────────────────────┐          │
│  │ 共通機能 (F-0xx): ダッシュボード、認証(Ph2)       │          │
│  └──────────────────────────────────────────────────┘          │
└─────────────────────────────────────────────────────────────────┘
```

---

## 2. 機能一覧サマリー

| カテゴリ | 機能ID | 機能名 | フェーズ | 優先度 |
|----------|--------|--------|---------|--------|
| 共通 | F-001 | ダッシュボード表示 | MVP | HIGH |
| 共通 | F-002 | ユーザー認証 | Phase 2 | HIGH |
| 情報収集 | F-101 | RSS収集 | MVP | HIGH |
| 情報収集 | F-102 | スクレイピング収集 | MVP | MEDIUM |
| 情報収集 | F-103 | 手動収集実行 | MVP | HIGH |
| 情報収集 | F-104 | 重複検出 | MVP | HIGH |
| AI分析 | F-201 | 記事評価（スコア算出） | MVP | HIGH |
| AI分析 | F-202 | 記事要約生成 | MVP | HIGH |
| AI分析 | F-203 | タグ自動付与 | MVP | MEDIUM |
| AI分析 | F-204 | AI再分析 | MVP | MEDIUM |
| レビュー | F-301 | 記事一覧表示 | MVP | HIGH |
| レビュー | F-302 | 記事詳細表示 | MVP | HIGH |
| レビュー | F-303 | 人間評価入力 | MVP | HIGH |
| レビュー | F-304 | 承認/却下 | MVP | HIGH |
| レビュー | F-305 | 一括操作 | MVP | MEDIUM |
| ソース管理 | F-401 | ソース一覧表示 | MVP | HIGH |
| ソース管理 | F-402 | ソース追加 | MVP | HIGH |
| ソース管理 | F-403 | ソース編集 | MVP | HIGH |
| ソース管理 | F-404 | ソース削除 | MVP | HIGH |
| ソース管理 | F-405 | 接続テスト | MVP | MEDIUM |
| レポート | F-501 | レポート生成 | MVP | MEDIUM |
| レポート | F-502 | レポート一覧表示 | MVP | MEDIUM |
| レポート | F-503 | レポートエクスポート | MVP | LOW |
| マニュアル | F-601 | マニュアル作成 | Phase 2 | HIGH |
| マニュアル | F-602 | マニュアル一覧表示 | Phase 2 | HIGH |
| マニュアル | F-603 | 関連マニュアルリンク | Phase 2 | MEDIUM |

---

## 3. 機能詳細

### F-001: ダッシュボード表示

| 項目 | 内容 |
|------|------|
| **機能ID** | F-001 |
| **機能名** | ダッシュボード表示 |
| **概要** | システム全体の統計情報と最近の記事を一覧表示し、主要操作へのクイックアクセスを提供する |
| **フェーズ** | MVP |
| **優先度** | HIGH |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | 統計カードを表示する（今週の収集数、未レビュー数、承認済み数、今月のAI分析数） |
| 2 | 各統計カードに前週比の増減率を表示する |
| 3 | 最近の記事リスト（10件）を表示する |
| 4 | クイックアクションボタン（収集実行、レポート生成）を配置する |

#### 関連API

| エンドポイント | 用途 |
|---------------|------|
| `GET /api/articles` | 最近の記事取得 |
| `GET /api/stats` | 統計情報取得 |

#### UI参照

- [PRD_03_UI_Specification.md](PRD_03_UI_Specification.md) - セクション 3.1

---

### F-101: RSS収集

| 項目 | 内容 |
|------|------|
| **機能ID** | F-101 |
| **機能名** | RSS収集 |
| **概要** | 登録されたRSSフィードから記事を自動収集する |
| **フェーズ** | MVP |
| **優先度** | HIGH |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | 登録済みRSSフィードURLから新着記事を取得する |
| 2 | 記事のタイトル、URL、公開日時、本文（最大5000文字）を抽出する |
| 3 | 取得した記事をarticlesテーブルに保存する |
| 4 | 既存記事との重複チェックを行う（F-104と連携） |

#### 入出力

| 種別 | 内容 |
|------|------|
| 入力 | RSSフィードURL（sourcesテーブルから取得） |
| 出力 | articlesテーブルへの新規レコード |

#### 関連API

| エンドポイント | 用途 |
|---------------|------|
| `POST /api/collect` | 収集ジョブ実行 |

---

### F-102: スクレイピング収集

| 項目 | 内容 |
|------|------|
| **機能ID** | F-102 |
| **機能名** | スクレイピング収集 |
| **概要** | RSS非対応サイトからHTMLパースで記事を収集する |
| **フェーズ** | MVP |
| **優先度** | MEDIUM |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | 登録済みサイトURLからHTMLを取得する |
| 2 | 設定されたCSSセレクタでタイトル・本文・日付を抽出する |
| 3 | Cheerioを使用した静的HTMLパースを行う |
| 4 | 対象サイトを限定し、過度なアクセスを避ける |

#### 技術仕様

| 項目 | 仕様 |
|------|------|
| ライブラリ | Cheerio |
| リクエスト間隔 | 最小1秒 |
| User-Agent | 適切な識別子を設定 |

#### スクレイピング設定例

```json
{
  "titleSelector": "h1.article-title",
  "contentSelector": "div.article-body",
  "dateSelector": "time.published",
  "dateFormat": "YYYY-MM-DD"
}
```

---

### F-103: 手動収集実行

| 項目 | 内容 |
|------|------|
| **機能ID** | F-103 |
| **機能名** | 手動収集実行 |
| **概要** | ユーザー操作により記事収集ジョブを即時実行する |
| **フェーズ** | MVP |
| **優先度** | HIGH |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | ダッシュボードの「収集実行」ボタンで即時実行する |
| 2 | 全アクティブソースを対象に収集を行う |
| 3 | 収集結果（成功/失敗件数）をToast通知で表示する |
| 4 | 収集中はボタンを無効化しスピナーを表示する |

#### 関連API

| エンドポイント | 用途 |
|---------------|------|
| `POST /api/collect` | 収集ジョブ実行 |

---

### F-104: 重複検出

| 項目 | 内容 |
|------|------|
| **機能ID** | F-104 |
| **機能名** | 重複検出 |
| **概要** | 収集時に既存記事との重複を検出し、重複登録を防止する |
| **フェーズ** | MVP |
| **優先度** | HIGH |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | URL正規化による完全一致チェックを行う |
| 2 | 同一ソース内でタイトル類似度90%以上の記事を重複とみなす |
| 3 | 重複判定された記事はスキップする |

#### 重複判定ロジック

```
1. URL正規化（トラッキングパラメータ除去、末尾スラッシュ統一）
2. 正規化URL完全一致 → 重複
3. 同一ソース + 7日以内 + タイトル類似度90%超 → 重複
```

#### 技術参照

- [PRD_02_Technical.md](PRD_02_Technical.md) - セクション 7

---

### F-201: 記事評価（スコア算出）

| 項目 | 内容 |
|------|------|
| **機能ID** | F-201 |
| **機能名** | 記事評価（スコア算出） |
| **概要** | Claude APIを使用して記事の重要度・有用度・難易度を自動評価する |
| **フェーズ** | MVP |
| **優先度** | HIGH |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | 収集した記事に対してClaude API (Haiku)で分析を実行する |
| 2 | 重要度（1-5）、有用度（1-5）、難易度（1-5）のスコアを算出する |
| 3 | 各スコアの評価理由を生成する |
| 4 | API失敗時は最大3回リトライする |
| 5 | 全リトライ失敗時はstatus='analysis_failed'として保存する |

#### 評価基準

| 軸 | 定義 |
|----|------|
| 重要度 | この情報を知らないとどれだけ損するか |
| 有用度 | 実際の作業でどれだけ使えるか |
| 難易度 | 初心者が理解・実装するのにどれだけかかるか |

#### 技術参照

- [PRD_02_Technical.md](PRD_02_Technical.md) - セクション 5.1
- [evaluation-criteria.md](../evaluation-criteria.md)

---

### F-202: 記事要約生成

| 項目 | 内容 |
|------|------|
| **機能ID** | F-202 |
| **機能名** | 記事要約生成 |
| **概要** | Claude APIを使用して記事の要約（100文字以内）を生成する |
| **フェーズ** | MVP |
| **優先度** | HIGH |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | 記事本文から100文字以内の要約を生成する |
| 2 | F-201（記事評価）と同一リクエストで処理する |
| 3 | 日本語で要約を生成する |

---

### F-203: タグ自動付与

| 項目 | 内容 |
|------|------|
| **機能ID** | F-203 |
| **機能名** | タグ自動付与 |
| **概要** | Claude APIを使用して記事に関連タグを自動付与する |
| **フェーズ** | MVP |
| **優先度** | MEDIUM |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | 記事内容から最大5個のタグを生成する |
| 2 | F-201（記事評価）と同一リクエストで処理する |
| 3 | タグは日本語または英語（技術用語）で生成する |

---

### F-204: AI再分析

| 項目 | 内容 |
|------|------|
| **機能ID** | F-204 |
| **機能名** | AI再分析 |
| **概要** | 分析失敗した記事またはユーザー指定の記事を再度AI分析する |
| **フェーズ** | MVP |
| **優先度** | MEDIUM |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | status='analysis_failed'の記事に「再分析」ボタンを表示する |
| 2 | ボタン押下でClaude APIによる再分析を実行する |
| 3 | 成功時はstatus='pending'に更新し、スコアを保存する |

#### 関連API

| エンドポイント | 用途 |
|---------------|------|
| `POST /api/articles/[id]/reanalyze` | 再分析実行 |

---

### F-301: 記事一覧表示

| 項目 | 内容 |
|------|------|
| **機能ID** | F-301 |
| **機能名** | 記事一覧表示 |
| **概要** | 収集した記事をフィルタリング・ソート可能な一覧で表示する |
| **フェーズ** | MVP |
| **優先度** | HIGH |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | 記事をカード形式で一覧表示する |
| 2 | ステータス、ソース、重要度でフィルタリングできる |
| 3 | タイトルでキーワード検索できる |
| 4 | 日付順、重要度順、有用度順でソートできる |
| 5 | 1ページ20件でページネーションする |

#### フィルター仕様

| フィルター | 選択肢 |
|-----------|--------|
| ステータス | すべて / 未レビュー / 承認済み / 却下 / 分析失敗 |
| ソース | すべて / [登録ソース一覧] |
| 重要度 | すべて / ★5 / ★4以上 / ★3以上 |

#### 関連API

| エンドポイント | 用途 |
|---------------|------|
| `GET /api/articles` | 記事一覧取得（ページネーション対応） |

#### UI参照

- [PRD_03_UI_Specification.md](PRD_03_UI_Specification.md) - セクション 3.2

---

### F-302: 記事詳細表示

| 項目 | 内容 |
|------|------|
| **機能ID** | F-302 |
| **機能名** | 記事詳細表示 |
| **概要** | 記事の詳細情報とAI評価結果を表示する |
| **フェーズ** | MVP |
| **優先度** | HIGH |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | 記事タイトル、ソース、公開日時、URLを表示する |
| 2 | AI生成要約を表示する |
| 3 | AI評価スコアと評価理由を表示する |
| 4 | 記事本文（抜粋）を表示する |
| 5 | 「元記事を開く」リンクを提供する |

#### 関連API

| エンドポイント | 用途 |
|---------------|------|
| `GET /api/articles/[id]` | 記事詳細取得 |

#### UI参照

- [PRD_03_UI_Specification.md](PRD_03_UI_Specification.md) - セクション 3.3

---

### F-303: 人間評価入力

| 項目 | 内容 |
|------|------|
| **機能ID** | F-303 |
| **機能名** | 人間評価入力 |
| **概要** | ユーザーがAI評価を確認し、必要に応じてスコアを修正する |
| **フェーズ** | MVP |
| **優先度** | HIGH |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | 重要度・有用度・難易度を1-5で入力できる |
| 2 | AI評価値を初期値として設定する |
| 3 | コメント（自由テキスト）を入力できる |
| 4 | 入力内容を保存できる |

#### UI参照

- [PRD_03_UI_Specification.md](PRD_03_UI_Specification.md) - セクション 3.3.3

---

### F-304: 承認/却下

| 項目 | 内容 |
|------|------|
| **機能ID** | F-304 |
| **機能名** | 承認/却下 |
| **概要** | レビュー完了後に記事のレポート掲載可否を決定する |
| **フェーズ** | MVP |
| **優先度** | HIGH |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | 「承認」ボタンでstatus='approved'に更新する |
| 2 | 「却下」ボタンでstatus='rejected'に更新する |
| 3 | 操作完了後はToast通知を表示する |
| 4 | レビュー日時（reviewed_at）を記録する |

#### 関連API

| エンドポイント | 用途 |
|---------------|------|
| `PUT /api/articles/[id]/review` | レビュー保存 |

---

### F-305: 一括操作

| 項目 | 内容 |
|------|------|
| **機能ID** | F-305 |
| **機能名** | 一括操作 |
| **概要** | 複数記事を選択して一括で承認/却下する |
| **フェーズ** | MVP |
| **優先度** | MEDIUM |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | 記事カードにチェックボックスを表示する |
| 2 | 選択時にフローティングバーを表示する |
| 3 | 「すべて承認」「すべて却下」ボタンを提供する |
| 4 | 実行前に確認モーダルを表示する |

#### UI参照

- [PRD_03_UI_Specification.md](PRD_03_UI_Specification.md) - セクション 3.2.3

---

### F-401: ソース一覧表示

| 項目 | 内容 |
|------|------|
| **機能ID** | F-401 |
| **機能名** | ソース一覧表示 |
| **概要** | 登録済みの監視対象サイトを一覧表示する |
| **フェーズ** | MVP |
| **優先度** | HIGH |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | ソースをテーブル形式で一覧表示する |
| 2 | サイト名、タイプ（RSS/Scrape）、URL、ステータス、記事数を表示する |
| 3 | 最終収集日時を表示する |
| 4 | 有効/無効をトグルスイッチで切り替えられる |

#### 関連API

| エンドポイント | 用途 |
|---------------|------|
| `GET /api/sources` | ソース一覧取得 |

#### UI参照

- [PRD_03_UI_Specification.md](PRD_03_UI_Specification.md) - セクション 3.4

---

### F-402: ソース追加

| 項目 | 内容 |
|------|------|
| **機能ID** | F-402 |
| **機能名** | ソース追加 |
| **概要** | 新しい監視対象サイトを登録する |
| **フェーズ** | MVP |
| **優先度** | HIGH |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | モーダルフォームでソース情報を入力する |
| 2 | サイト名、タイプ、URL、（RSSの場合）フィードURLを入力できる |
| 3 | スクレイピングの場合はセレクタ設定を入力できる |
| 4 | URL重複チェックを行う |

#### 関連API

| エンドポイント | 用途 |
|---------------|------|
| `POST /api/sources` | ソース追加 |

---

### F-403: ソース編集

| 項目 | 内容 |
|------|------|
| **機能ID** | F-403 |
| **機能名** | ソース編集 |
| **概要** | 登録済みソースの情報を編集する |
| **フェーズ** | MVP |
| **優先度** | HIGH |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | 編集モーダルで既存情報を修正できる |
| 2 | サイト名、タイプ、URL、フィードURL、スクレイピング設定を編集できる |

#### 関連API

| エンドポイント | 用途 |
|---------------|------|
| `PUT /api/sources/[id]` | ソース更新 |

---

### F-404: ソース削除

| 項目 | 内容 |
|------|------|
| **機能ID** | F-404 |
| **機能名** | ソース削除 |
| **概要** | 登録済みソースを削除する |
| **フェーズ** | MVP |
| **優先度** | HIGH |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | 削除前に確認モーダルを表示する |
| 2 | 関連記事数を確認モーダルに表示する |
| 3 | ソース削除時に関連記事も削除する（CASCADE） |

#### 関連API

| エンドポイント | 用途 |
|---------------|------|
| `DELETE /api/sources/[id]` | ソース削除 |

---

### F-405: 接続テスト

| 項目 | 内容 |
|------|------|
| **機能ID** | F-405 |
| **機能名** | 接続テスト |
| **概要** | ソース追加/編集時に接続テストを実行して取得可否を確認する |
| **フェーズ** | MVP |
| **優先度** | MEDIUM |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | 「接続テスト」ボタンで指定URLへのテスト取得を実行する |
| 2 | 取得成功時は取得件数とサンプルタイトルを表示する |
| 3 | 取得失敗時はエラーメッセージを表示する |

---

### F-501: レポート生成

| 項目 | 内容 |
|------|------|
| **機能ID** | F-501 |
| **機能名** | レポート生成 |
| **概要** | 指定期間の承認済み記事から週次レポートを生成する |
| **フェーズ** | MVP |
| **優先度** | MEDIUM |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | 開始日・終了日を指定してレポートを生成する |
| 2 | 対象記事数をリアルタイムで表示する |
| 3 | 0件の場合は生成ボタンを無効化する |
| 4 | レポート内容はMarkdown形式で保存する |

#### レポート構成

```
# 週次レポート YYYY年第N週

## ハイライト
- 重要度5の記事
- 特筆すべき発見

## カテゴリ別まとめ
### [タグ1]
- 記事1
- 記事2

### [タグ2]
...
```

#### 関連API

| エンドポイント | 用途 |
|---------------|------|
| `POST /api/reports/generate` | レポート生成 |

---

### F-502: レポート一覧表示

| 項目 | 内容 |
|------|------|
| **機能ID** | F-502 |
| **機能名** | レポート一覧表示 |
| **概要** | 生成済みレポートを一覧表示する |
| **フェーズ** | MVP |
| **優先度** | MEDIUM |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | レポートをカード形式で一覧表示する |
| 2 | タイトル、期間、記事数、生成日時、ステータスを表示する |
| 3 | ハイライト（上位2-3記事）をプレビュー表示する |
| 4 | プレビューモーダルで内容を確認できる |

#### 関連API

| エンドポイント | 用途 |
|---------------|------|
| `GET /api/reports` | レポート一覧取得 |

#### UI参照

- [PRD_03_UI_Specification.md](PRD_03_UI_Specification.md) - セクション 3.5

---

### F-503: レポートエクスポート

| 項目 | 内容 |
|------|------|
| **機能ID** | F-503 |
| **機能名** | レポートエクスポート |
| **概要** | レポートを各種形式でコピー/ダウンロードする |
| **フェーズ** | MVP |
| **優先度** | LOW |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | Markdown形式でクリップボードにコピーできる |
| 2 | Slack形式（絵文字記法）でコピーできる |
| 3 | プレーンテキスト形式でコピーできる |

---

### F-601: マニュアル作成

| 項目 | 内容 |
|------|------|
| **機能ID** | F-601 |
| **機能名** | マニュアル作成 |
| **概要** | 記事を元にステップバイステップのマニュアルを作成する |
| **フェーズ** | Phase 2 |
| **優先度** | HIGH |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | AIがマニュアルドラフトを生成する |
| 2 | ユーザーがドラフトを編集できる |
| 3 | Markdownエディタで編集できる |
| 4 | 下書き/公開状態を管理できる |

#### マニュアルテンプレート

```markdown
# [タイトル]

## 概要
[このマニュアルで何ができるようになるか]

## 前提条件
- [必要な知識・環境]

## 手順
### Step 1: [アクション]
[詳細説明とコード例]

## 確認方法
[正しく完了したか確認する方法]

## トラブルシューティング
| 症状 | 原因 | 対処法 |

## 関連マニュアル
- [リンク]
```

---

### F-602: マニュアル一覧表示

| 項目 | 内容 |
|------|------|
| **機能ID** | F-602 |
| **機能名** | マニュアル一覧表示 |
| **概要** | 作成済みマニュアルを一覧表示する |
| **フェーズ** | Phase 2 |
| **優先度** | HIGH |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | マニュアルをカード形式で一覧表示する |
| 2 | タイトル、タグ、難易度、ステータスを表示する |
| 3 | タグでフィルタリングできる |
| 4 | キーワード検索できる |

#### 関連API

| エンドポイント | 用途 |
|---------------|------|
| `GET /api/manuals` | マニュアル一覧取得 |

---

### F-603: 関連マニュアルリンク

| 項目 | 内容 |
|------|------|
| **機能ID** | F-603 |
| **機能名** | 関連マニュアルリンク |
| **概要** | マニュアル間の相互参照リンクを設定する |
| **フェーズ** | Phase 2 |
| **優先度** | MEDIUM |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | マニュアル編集時に関連マニュアルを選択できる |
| 2 | 選択式UI（手動選択）で関連を設定する |
| 3 | 関連マニュアルをマニュアル詳細画面に表示する |

---

### F-002: ユーザー認証

| 項目 | 内容 |
|------|------|
| **機能ID** | F-002 |
| **機能名** | ユーザー認証 |
| **概要** | Supabase Authを使用したユーザー認証機能 |
| **フェーズ** | Phase 2 |
| **優先度** | HIGH |

#### 機能要件

| # | 要件 |
|---|------|
| 1 | メールアドレス/パスワードでログインできる |
| 2 | 未認証ユーザーはログインページにリダイレクトする |
| 3 | Row Level Security (RLS)でデータアクセスを制御する |

#### 技術参照

- [PRD_02_Technical.md](PRD_02_Technical.md) - セクション 8.2

---

## 4. 機能間依存関係

```
F-402 (ソース追加)
    ↓
F-101/F-102 (収集)
    ↓
F-104 (重複検出) ←→ F-201~F-203 (AI分析)
    ↓
F-301~F-302 (記事表示)
    ↓
F-303~F-304 (レビュー)
    ↓
F-501 (レポート生成)
    ↓
F-601 (マニュアル作成) [Phase 2]
```

---

## 5. 承認履歴

| 日付 | バージョン | 内容 |
|------|-----------|------|
| 2026-02-01 | 1.0 | 初版作成（既存仕様書から機能抽出・整理） |
